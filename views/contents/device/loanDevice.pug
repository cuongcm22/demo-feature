doctype html
head
  meta(charset='UTF-8')
  meta(name='viewport' content='width=device-width, initial-scale=1.0')
  title Borrow Device Form
  link(href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css' rel='stylesheet')
  include ../../partials/header.pug

//- Truyền biến JavaScript vào Pug bằng cách sử dụng `locals`
- var navUrl = ['Report', 'Create', 'Loan', 'Return']
- var local = 'device'
mixin article({navUrl, local})
  include ../../components/navigation.pug 
    
//- Sử dụng biến JavaScript trong mixin
+article({navUrl, local})

  style.
    /* Customize styles here */

.container.mt-5
  .content
    h2.mb-4 Borrow Device Form
    form#borrowForm(action='/device/loan' method='post' enctype='multipart/json')
      .mb-3
        label.form-label(for='deviceSelect') Select Device
        select#deviceSelect.form-select(name='deviceId' required='')
          option(value='' selected='' disabled='') Select Device
      #deviceInfo.mb-3
        // Device info will be displayed here
      .mb-3
        label.form-label(for='loanDate') Ng&agrave;y M&#x1B0;&#x1EE3;n:
        input#loanDate.form-control(type='date' name='loanDate' required='')
      .mb-3
        label.form-label(for='returnDate') Ng&agrave;y Tr&#x1EA3; (D&#x1EF1; ki&#x1EBF;n):
        input#returnDate.form-control(type='date' name='returnDate' required='')
      button.btn.btn-primary(type='submit') Submit
script.
  var data = !{data}

  // Populate device select options
  var deviceSelect = document.getElementById("deviceSelect");
  var deviceInfo = document.getElementById("deviceInfo");
  data.forEach(function (device) {
  var option = document.createElement("option");
  option.value = device.deviceID;
  option.textContent = device.deviceName;
  deviceSelect.appendChild(option);
  });
  // Function to display device info when selected
  deviceSelect.addEventListener("change", function () {
  var selectedDeviceID = deviceSelect.value;
  var selectedDevice = data.find(function (device) {
  return device.deviceID === selectedDeviceID;
  });
  if (selectedDevice) {
  deviceInfo.innerHTML = `
  <h4>Device Information:</h4>
  <p><strong>Device Name:</strong> ${selectedDevice.deviceName}</p>
  <p><strong>Location:</strong> ${selectedDevice.deviceLocation}</p>
  <p><strong>Supplier:</strong> ${selectedDevice.deviceSupplier}</p>
  ${selectedDevice.deviceImage ? `<img class="w-100" src="../../${selectedDevice.deviceImage}" alt="Device Image">` : ''}
  ${selectedDevice.deviceVideo ? `<video class="w-100" controls><source src="../../${selectedDevice.deviceVideo}" type="video/mp4"></video>` : ''}
  `;
  } else {
  deviceInfo.innerHTML = ""; // Clear device info if no device selected
  }
  });
  // Function to handle form submission
  //- document.getElementById("borrowForm").addEventListener("submit", function (event) {
  //- event.preventDefault();
  //- var selectedDeviceID = deviceSelect.value;
  //- var selectedDevice = data.find(function (device) {
  //- return device.deviceID === selectedDeviceID;
  //- });
  //- var loanDate = document.getElementById("loanDate").value;
  //- var returnDate = document.getElementById("returnDate").value;
  //- if (selectedDevice) {
  //- console.log("Selected Device:", selectedDevice);
  //- console.log("Loan Date:", loanDate);
  //- console.log("Return Date:", returnDate);
  //- // Perform further actions as needed, like submitting the form data
  //- } else {
  //- alert("Please select a device.");
  //- }
  //- });
